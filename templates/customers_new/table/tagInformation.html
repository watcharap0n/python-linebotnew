{% extends "customers_new/layout.html" %}
{% block content %}



    <div class="container-fluid" style="margin-top: 30px">

        <h1 class="h3 mb-2 text-gray-800">Boardcast</h1>

        <div class="row">
            <div class="col-xl-6 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                    <div class="card-body">
                        <div class="col mr-2">
                            <form class="user" method="POST" action="">
                                <div class="row">
                                    <div class="col-sm-8">
                                        <label for="broadcast"
                                               class="text-xs font-weight-bold text-danger text-uppercase mb-1">Text:</label>
                                        <input type="text" class="form-control" id="broadcast" name="msg" required>
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="col-sm-8">
                                        <label for="broadcast"
                                               class="text-xs font-weight-bold text-danger text-uppercase mb-1">Image
                                            URL:</label>
                                        <input type="text" class="form-control" id="broadcast_img" name="bcImg">
                                    </div>
                                    <div class="col-sm-4">
                                        <br>
                                        <button type="submit" class="btn btn-outline-success">
                                            <i class="fa fa-bullhorn" aria-hidden="true"></i>
                                            Boardcast
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-6 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">จำนวนข้อความ
                                </div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800 mm">{{ data.msg }}</div>
                            </div>
                            <div class="">
                                <i class="fas fa-comments fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card shadow mb-4">
            <div class="card-header py-3">
                <div class="row">
                    <div class="col-sm-8">
                        <ul class="nav nav-pills" role="tablist">
                            <li class="nav-item" style="margin-left: 10px">
                                <a href="/marketing_information">
                                    <button
                                            class="btn btn-outline-success" data-toggle="tooltip"
                                            title="New Customers">
                                        <i class="fa fa-user" aria-hidden="true"></i>
                                        ข้อมูลลูกค้า
                                        <span class="badge badge-light">{{ data.amount_information }}</span>
                                    </button>
                                </a>
                            </li>

                            <li class="nav-item" style="margin-left: 10px">
                                <a href="/marketing_import">
                                    <button
                                            class="btn btn-outline-success" data-toggle="tooltip"
                                            title="New Customers">
                                        <i class="fa fa-reply" aria-hidden="true"></i>
                                        นำเข้า
                                        <span class="badge badge-light">{{ data.amount_import }}</span>
                                    </button>
                                </a>
                            </li>

                            <li class="nav-item" style="margin-left: 10px">
                                <a href="/getDemo">
                                    <button
                                            class="btn btn-outline-success" data-toggle="tooltip"
                                            title="New Customers">
                                        <i class="fa fa-globe" aria-hidden="true"></i>
                                        นัดDemo
                                        <span class="badge badge-light">{{ data.amount_getDemo }}</span>
                                    </button>
                                </a>
                            </li>
                        </ul>
                    </div>

                    <div class="col-sm-4" style="text-align: end">
                        <div class="align-content-end">
                            <a href="/excel_all/information" class="btn btn-outline-success btn-sm">
                                <i class="fa fa-file-excel-o"></i>
                                Export Excel
                            </a>

                            <button type="button" class="btn btn-outline-danger btn-sm" data-toggle="modal" data-target="#myModal">
                                <i class="fa fa-trash" aria-hidden="true"></i>
                                Remove All
                            </button>
                            <div class="modal" id="myModal">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title">Confirm Delete</h4>
                                            <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        </div>
                                        <div class="modal-body">
                                            Delete all transaction... <br>
                                            Are you sure ?
                                        </div>
                                        <div class="modal-footer">
                                            <a {% for d in data.information %}
                                                href="/delete/{{ d.key }}"
                                            {% endfor %} class="btn btn-danger btn">Remove All</a>
                                            <button type="button" class="btn btn-danger btn" data-dismiss="modal">Close
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <form action="" method="POST">
                <div class="card-body">
                    <div class="tab-content">
                        <div id="information" class="tab-pane active">
                            <div class="footer">
                                <div class="dropdown" style="margin-bottom: 15px">
                                    <button type="button" class="btn btn-outline-secondary dropdown-toggle"
                                            data-toggle="dropdown">
                                        Tag Sort
                                    </button>
                                    <div class="dropdown-menu">
                                        <li class="dropdown-header">Select Tag</li>
                                        <li class="divider"></li>
                                        {% for tag in data.tag %}
                                            <a class="dropdown-item">
                                                <input class="tag_sort"
                                                       type="checkbox"
                                                       name="tags"
                                                       id="{{ tag }}"
                                                       value="{{ tag }}"
                                                        {% if tag in data %} checked {% endif %}>
                                                <label for="{{ tag }}" class="getvalue" data-toggle="{{ tag }}"
                                                       title="">
                                                    {% if tag == 'CB010' %}
                                                        รับเหมาสาธารณูปโภค
                                                    {% endif %}
                                                    {% if tag == 'CC010' %}
                                                        รับเหมาก่อสร้างระบบวางท่อ
                                                    {% endif %}
                                                    {% if tag == 'CG010' %}
                                                        งานระบบประกอบอาคาร
                                                    {% endif %}
                                                    {% if tag == 'CI010' %}
                                                        รับเหมาก่อสร้างพลังงานทดแทน
                                                    {% endif %}
                                                    {% if tag == 'CJ010' %}
                                                        รับเหมาก่อสร้างงานอาคาร
                                                    {% endif %}
                                                    {% if tag == 'CM010' %}
                                                        ออกแบบตกแต่ง
                                                    {% endif %}
                                                    {% if tag == 'CF010' %}
                                                        รับเหมาขุดเจาะ
                                                    {% endif %}
                                                    {% if tag == 'CP010' %}
                                                        งานอลูมิเนียม
                                                    {% endif %}
                                                    {% if tag == 'CE010' %}
                                                        ผลิตและติดตั้ง
                                                    {% endif %}
                                                    {% if tag == 'CH010' %}
                                                        งานบริการ
                                                    {% endif %}
                                                    {% if tag == 'CK010' %}
                                                        รับสร้างบ้าน
                                                    {% endif %}
                                                    {% if tag == 'CN010' %}
                                                        ไม่แน่ใจ
                                                    {% endif %}
                                                    {% if tag == 'CD010' %}
                                                        ขาย
                                                    {% endif %}
                                                    {% if tag == 'RC010' %}
                                                        อสังหาฯ
                                                    {% endif %}
                                                    {% if tag == 'RA010' %}
                                                        แนวราบ
                                                    {% endif %}
                                                    {% if tag == 'RB010' %}
                                                        แนวสูง
                                                    {% endif %}
                                                </label>
                                            </a>
                                        {% endfor %}
                                        <hr>
                                        <button type="submit" name="button_event" style="margin-left: 10px"
                                                value="button_tag"
                                                class="btn btn-secondary btn-sm"
                                        >
                                            <i class="fas fa-tags"></i>
                                            Apply
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="display" id="informationTable">
                                    <thead>
                                    <tr>
                                        <th>
                                            <input type="checkbox" name="select" id="select-all-information">
                                        </th>
                                        <th data-visible="false">Index</th>
                                        <th>แท็ก</th>
                                        <th>ชื่อ</th>
                                        <th>ผลิตภัณฑ์</th>
                                        <th>ผลิตภัณฑ์อื่น</th>
                                        <th>บริษัท</th>
                                        <th>เบอร์</th>
                                        <th>อีเมล</th>
                                        <th>อีเมล(ไลน์)</th>
                                        <th>ข้อความ</th>
                                        <th>ชื่อโปรไฟล์</th>
                                        <th>วัน/เวลา</th>
                                        <th>ช่องทาง</th>
                                        <th>นำเข้าโดย</th>
                                        <th>วันเวลานำเข้า</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for info in data.lst %}
                                        <tr>
                                            <td>
                                                <div class="form-group">
                                                    <input type="checkbox"
                                                           name="key_information"
                                                           id="{{ info.key }}"
                                                           value="{{ info.key }}"
                                                            {% if info.key in data.lst.key %}
                                                           checked {% endif %}>
                                                </div>
                                            </td>
                                            <td>{{ info.index }}</td>
                                            <td>
                                                {% set notvalue = '' %}
                                                {% if notvalue not in info.Tag %}
                                                    <button type="button" class="btn btn-success btn-xs"
                                                            data-toggle="collapse"
                                                            data-target="#liff">
                                                        <i class="fas fa-tags"></i>
                                                    </button>
                                                {% endif %}
                                                <div id="liff" class="collapse">
                                                    {% for tag in info.Tag %}
                                                        {% if tag %}
                                                            <a href="tagliff/{{ tag }}">
                                                                <span id="{{ tag }}"
                                                                      class="badge badge-secondary Filter_kane CC010">
                                                                        <i class="fas fa-tags"></i>
                                                                    {% if tag == 'CB010' %}
                                                                        รับเหมาสาธารณูปโภค
                                                                    {% elif tag == 'CC010' %}
                                                                        รับเหมาก่อสร้างระบบวางท่อ
                                                                    {% elif tag == 'CG010' %}
                                                                        งานระบบประกอบอาคาร
                                                                    {% elif tag == 'CI010' %}
                                                                        รับเหมาก่อสร้างพลังงานทดแทน
                                                                    {% elif tag == 'CJ010' %}
                                                                        รับเหมาก่อสร้างงานอาคาร
                                                                    {% elif tag == 'CM010' %}
                                                                        ออกแบบ ตกแต่ง
                                                                    {% elif tag == 'CF010' %}
                                                                        รับเหมาขุดเจาะ
                                                                    {% elif tag == 'CP010' %}
                                                                        งานอลูมิเนียม
                                                                    {% elif tag == 'CE010' %}
                                                                        ผลิตและติดตั้ง
                                                                    {% elif tag == 'CH010' %}
                                                                        งานบริการ
                                                                    {% elif tag == 'CK010' %}
                                                                        รับสร้างบ้าน
                                                                    {% elif tag == 'CN010' %}
                                                                        ไม่แน่ใจ
                                                                    {% elif tag == 'CD010' %}
                                                                        ขาย
                                                                    {% elif tag == 'RC010' %}
                                                                        อสังหาฯ
                                                                    {% elif tag == 'RA010' %}
                                                                        แนวราบ
                                                                    {% elif tag == 'RB010' %}
                                                                        แนวสูง
                                                                    {% endif %}
                                                                </span>
                                                            </a>
                                                        {% endif %}
                                                    {% endfor %}
                                                </div>
                                            </td>
                                            <td>{{ info.Name }}</td>
                                            <td>{{ info.Product }}</td>
                                            <td>{{ info.Other }}</td>
                                            <td>{{ info.Company }}</td>
                                            <td>{{ info.Tel }}</td>
                                            <td>{{ info.Email }}</td>
                                            <td>{{ info.EmailLiff }}</td>
                                            <td>{% set notvalue = 'None' %}
                                                {% if notvalue not in info.Message %}
                                                    <button type="button" class="btn btn-primary btn-xs"
                                                            data-toggle="collapse"
                                                            data-target="#message">
                                                        <i class="fa fa-commenting-o" aria-hidden="true"></i>
                                                    </button>
                                                {% endif %}
                                                <div id="message" class="collapse">
                                                    {{ info.Message }}
                                                </div>
                                            </td>
                                            <td>{{ info.Profile }}</td>
                                            <td>{{ info.Date }} {{ info.Time }}</td>
                                            <td>{{ info.Channel }}</td>
                                            <td>{{ info.Username }}</td>
                                            <td>{{ info.DateInsert }} {{ info.TimeInsert }}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>


                            </div>
                            <br>
                            <div class="footer">
                                <div class="row" style="margin-left: 15px">
                                    <div style="margin-right: 12px">
                                        <button type="submit" name="button_event" value="button_excel"
                                                class="btn btn-warning btn-sm">
                                            <i class="fa fa-check-square-o"></i>
                                            Excel Index
                                        </button>
                                    </div>
                                    <div style="margin-right: 12px">
                                        <button type="submit" name="button_event" value="button_delete"
                                                class="btn btn-danger btn-sm">
                                            <i class="fa fa-check-square-o"></i>
                                            Delete Index
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>

    </div>



    <script>
        $(document).ready(function () {
            $('#informationTable').DataTable({
                // "order": [[0, "desc"]]
                "columnDefs": [
                    {"orderable": false, "targets": 0},
                ]
            });
        });

        document.getElementById('select-all-information').onclick = function () {
            var checkboxes = document.getElementsByName('key_information');
            for (var checkbox of checkboxes) {
                checkbox.checked = this.checked;
            }
        }
    </script>



{% endblock %}